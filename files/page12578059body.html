<!--allrecords--><div id="allrecords" data-tilda-export="yes" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="14542" data-tilda-page-id="12578059" data-tilda-page-alias="blog/imenovannye-diapazony-excel-s-avtomaticheskoj-podstrojkoj" data-tilda-formskey="2bb761110255242a2bbb1bf3f837b680" data-tilda-lazy="yes" data-tilda-project-headcode="yes"><!--header--><div id="t-header" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="14542" data-tilda-page-id="61936" data-tilda-page-alias="header" data-tilda-formskey="2bb761110255242a2bbb1bf3f837b680" data-tilda-project-headcode="yes"></div><!--/header--><div id="rec209900431" class="r t-rec" style=" " data-animationappear="off" data-record-type="891" ><!-- cover --><div class="t-cover" id="recorddiv209900431" bgimgfield="img" style="height:450px; background-image:-webkit-linear-gradient(top, #ccc, #777); background-image:-moz-linear-gradient(top, #ccc, #777); background-image:-o-linear-gradient(top, #ccc, #777); background-image:-ms-linear-gradient(top, #ccc, #777); background-image:linear-gradient(top, #ccc, #777); " ><div class="t-cover__carrier" id="coverCarry209900431" data-content-cover-id="209900431" data-content-cover-bg="" data-content-cover-height="450px" data-content-cover-parallax="" style="height:450px;background-attachment:scroll; "></div> <div class="t-cover__filter" style="height:450px;background-image: -moz-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: -webkit-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: -o-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: -ms-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#000e1f2f', endColorstr='#00182d42');"></div><div class="t891"> <div class="t-container"> <div class="t-col t-col_12"> <div class="t-cover__wrapper t-valign_middle" style="height:450px;"> <div class="t891__wrapper" data-hook-content="covercontent"> <div class="t891__title t-title t-title_xl" style="padding-top:100px;text-shadow: 0px 2px 5px rgba(0, 0, 0, 0.0);" field="title"><div style="font-size:46px;text-align:left;" data-customstyle="yes">Именованные диапазоны Excel<br /> с автоматической подстройкой<br /></div></div> <div class="t891__descr t-descr t-descr_xl " style="" field="descr"><div style="font-size:18px;text-align:left;" data-customstyle="yes">Адаптированный перевод статьи Тома Огера (Tom Auger)<br /> Named Ranges in Excel that Automatically Expand (Dynamic Ranges Part 1). <br />Статья была доступна <a href="http://www.tomauger.com/?s=Named+Ranges+in+Excel+that+Automatically+Expand">здесь</a>.</div></div> <span class="space"></span> </div> </div> </div> </div></div> </div> </div><div id="rec209900432" class="r t-rec t-rec_pt_90 t-rec_pb_15" style="padding-top:90px;padding-bottom:15px; " data-record-type="296" ><!-- t265 --><div class="t265"> <div class="t-container"> <div class="t-col t-col_8 t-prefix_2"> <div class="t265__wrapper" style="background:#fafafa;"> <div class="t265__icon"> <svg x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;"> <circle style="fill:#edbd11;" cx="12.125" cy="12.125" r="12"/> <g> <path style="fill:#ffffff;" d="M10.922,6.486c0-0.728,0.406-1.091,1.217-1.091s1.215,0.363,1.215,1.091c0,0.347-0.102,0.617-0.304,0.81 c-0.202,0.193-0.507,0.289-0.911,0.289C11.328,7.585,10.922,7.219,10.922,6.486z M13.252,17.792h-2.234V9.604h2.234V17.792z"/> </g> </svg> </div> <div class="t265__text t-descr t-descr_xs" style="color:#000000;" field="text"><div style="font-size:14px;" data-customstyle="yes">Названия функций даются заглавными буквами, пункты меню и некоторые термины выделены курсивом. Также к первоначальному тексту добавлены примеры.</div></div> </div> </div> </div></div></div><div id="rec209900434" class="r t-rec t-rec_pt_15 t-rec_pb_0" style="padding-top:15px;padding-bottom:0px; " data-record-type="128" ><!-- T120 --><div class="t120"> <div class="t-container t-align_left"> <div class="t-col t-col_8 t-prefix_2"> <h3 class="t120__title t-heading t-heading_sm" field="title" style="font-size:16px;">Что такое даты для Excel?<br /></h3> </div> </div></div></div><div id="rec209900435" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Именованные диапазоны в Excel — это отличный инструмент. Они позволяют делать такие вещи, как выпадающие списки в пункте <em>Проверка данных</em>. Или можно присвоить имя диапазону с данными и в дальнейшем ссылаться на него вместо того, чтобы указывать координаты (A1:B5). <br /><br /> Одна из неприятностей, связанных с поддержкой списков — необходимость править диапазон в <em>Формулы &gt; Диспетчер имён</em> после каждого добавления/удаления строк данных в исходном диапазоне. Чтобы избежать подобной ситуации, можно создать динамический диапазон, применив формулы вместо жёстко заданных координат. Чаще всего используется функция СМЕЩ, как показано ниже. Запрос «Excel динамический диапазон» в любом поисковике вернёт сотни ссылок, большинство из которых будут вариантами формулы: <br /><br /> =СМЕЩ(Лист!$A$1, 0, 0, СЧЁТЗ ($A:$A), 1) <br /><br /> СМЕЩ возвращает диапазон, модифицированный относительно базового – пункт <em>Ссылка</em>. Смещ<em>по</em>строкам и Смещ<em>по</em>столбцам смещают начало диапазона на соответствующее число строк и столбцов. Высота и Ширина задают количество строк и столбцов в диапазоне. <br /><br /> Ссылка: обычно указывается верхняя левая ячейка именованного диапазона. <br /><br /> Смещ<em>по</em>строкам: обычно 0, т.к. стартовую позицию мы уже определили. <br /><br /> Смещ<em>по</em>столбцам: так же обычно 0, по той же самой причине. <br /><br /> Высота: количество строк нашего диапазона (здесь будет формула, см. ниже). <br /><br /> Ширина: количество столбцов в нашем диапазоне (минимум 1). <br /><br /> Понятно, что функция СМЕЩ сама по себе не слишком полезна для наших целей. Если вы собираетесь использовать статические числа, то откажитесь от СМЕЩ, непосредственно прописав диапазон. Причина, по которой мы используем СМЕЩ — возможность замены параметров (аргументов) формулами. Они и позволяют получить динамическую часть. <br /><br /> Типичная формула динамического диапазона, которую можно найти на просторах интернета, использует СЧЁТ (для числовых данных) или СЧЁТЗ (для текста). Обе эти функции подсчитывают количество непустых ячеек. Если мы подсчитаем количество непустых ячеек в одном столбце и введём это число в параметр Высота, то мы получим диапазон от начальной ячейки до последней ячейки с записью. Но это в теории. <br /><br /> В действительности, если вы внимательно читали, мы получим диапазон высотой в то количество строк, которое мы получили от СЧЁТЗ. Если в диапазоне присутствуют пустые ячейки, то выходной диапазон окажется короче, чем необходимо, и последние ячейки потеряются. Помните об этой тонкости. <br /><br /> Наиболее часто динамический диапазон используется в следующих случаях: <br /><br /> <ul> <li> в ссылках в формулах для других таблиц </li> <li> для определения исходных диапазонов сводных таблиц </li> <li> для определения исходных диапазонов диаграмм </li> <li> для определения наборов переменных выпадающих списков </li> </ul> Если у нас есть таблица, в которой меняется количество строк, и есть формулы, использующие ссылку на эту таблицу, то применение динамического диапазона вполне логичный шаг. Допустим у нас есть «база данных», в которую мы заносим каждое обращение клиента, и мы хотим подсчитать количество обращений определённого клиента. Тогда можно сделать нечто такое:<br /></div></div></div></div></div></div><div id="rec209900436" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild6532-3463-4830-b966-346362323466__-__empty__iw5tbfu6tz-fjgtzo-f6.jpg" data-original="images/tild6532-3463-4830-b966-346362323466__iw5tbfu6tz-fjgtzo-f6.jpg" imgfield="img" /><meta itemprop="image" content="images/tild6532-3463-4830-b966-346362323466__iw5tbfu6tz-fjgtzo-f6.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209901158" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3237-6630-4638-a462-623331613038__-__empty__udcs6mf7aqmln0nkryvk.jpg" data-original="images/tild3237-6630-4638-a462-623331613038__udcs6mf7aqmln0nkryvk.jpg" imgfield="img" /><meta itemprop="image" content="images/tild3237-6630-4638-a462-623331613038__udcs6mf7aqmln0nkryvk.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209900437" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Сначала мы создаём динамический именованный диапазон с помощью Диспетчера имён, после чего используем в нашей формуле. <br /><br /> Формулы, которые мы использовали: <br /><br /> СЧЁТЕСЛИ(диапКод;G3) <br /><br /> СМЕЩ(Лист1!$A$2;0;0;СЧЁТЗ(Лист1!$A$2:$A$100);1) <br /><br /> Следующий вариант применения динамического диапазона — сводные таблицы. Воспользуемся «базой» из предыдущего примера. Нам придётся видоизменить формулу динамического диапазона, так как нужно включить заголовки столбцов и включить второй столбец. Мы хотим получить общую сумму для каждого клиента. <br /><br /> Вот начальные данные:<br /></div></div></div></div></div></div><div id="rec209900438" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3534-6539-4136-b735-336434383239__-__empty__b3bwfkhk_kec03dyf0uq.jpg" data-original="images/tild3534-6539-4136-b735-336434383239__b3bwfkhk_kec03dyf0uq.jpg" imgfield="img" /><meta itemprop="image" content="images/tild3534-6539-4136-b735-336434383239__b3bwfkhk_kec03dyf0uq.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209900439" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes"> А вот после добавки новых строк (не забываем нажать <em>Обновить</em>):</div></div></div></div></div></div><div id="rec209900440" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild6633-3630-4030-a536-613662383665__-__empty__vrbvfezi1dfzysrwmijw.jpg" data-original="images/tild6633-3630-4030-a536-613662383665__vrbvfezi1dfzysrwmijw.jpg" imgfield="img" /><meta itemprop="image" content="images/tild6633-3630-4030-a536-613662383665__vrbvfezi1dfzysrwmijw.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209900442" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Формула диапазона: <br /><br /> СМЕЩ(Лист1!$A$1;0;0;СЧЁТЗ(Лист1!$A$1:$A$100);2) <br /><br /> Третий вариант использования динамического диапазона — определение исходного диапазона для диаграмм. Здесь выводится график, диапазон исходных данных которого регулируется параметром.<br /></div></div></div></div></div></div><div id="rec209900443" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3438-6361-4163-a239-386234643762__-__empty__vmfinvtufniv3lcjhugu.jpg" data-original="images/tild3438-6361-4163-a239-386234643762__vmfinvtufniv3lcjhugu.jpg" imgfield="img" /><meta itemprop="image" content="images/tild3438-6361-4163-a239-386234643762__vmfinvtufniv3lcjhugu.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209901910" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3338-3837-4431-b131-643039306133__-__empty__lr_cqabjsy3ubvxuwjvs.jpg" data-original="images/tild3338-3837-4431-b131-643039306133__lr_cqabjsy3ubvxuwjvs.jpg" imgfield="img" /><meta itemprop="image" content="images/tild3338-3837-4431-b131-643039306133__lr_cqabjsy3ubvxuwjvs.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209900444" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes"> В данном примере использованы два динамических диапазона.</div></div></div></div></div></div><div id="rec209900445" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3266-6331-4361-a637-646666316438__-__empty__tv01pf92gkcwgtikjylk.jpg" data-original="images/tild3266-6331-4361-a637-646666316438__tv01pf92gkcwgtikjylk.jpg" imgfield="img" /><meta itemprop="image" content="images/tild3266-6331-4361-a637-646666316438__tv01pf92gkcwgtikjylk.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209900446" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Последний пример, который мы рассмотрим – создание выпадающих списков посредством инструмента <em>Проверка данных</em>. Этот инструмент применяется, когда мы хотим ограничить пользователя при вводе данных в ячейку. В столбец А мы поместили допустимый набор данных, а в столбце Н создали выпадающие списки (как их создавать здесь не рассматривается).</div></div></div></div></div></div><div id="rec209900447" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild6139-3736-4561-a234-323637386231__-__empty__3p0pj8_khfxtug73dng4.jpg" data-original="images/tild6139-3736-4561-a234-323637386231__3p0pj8_khfxtug73dng4.jpg" imgfield="img" /><meta itemprop="image" content="images/tild6139-3736-4561-a234-323637386231__3p0pj8_khfxtug73dng4.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209900448" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes"> После добавления новых строк:</div></div></div></div></div></div><div id="rec209900449" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild6136-6139-4432-a161-643330393139__-__empty__0-yd9t51vzw2utez0tje.jpg" data-original="images/tild6136-6139-4432-a161-643330393139__0-yd9t51vzw2utez0tje.jpg" imgfield="img" /><meta itemprop="image" content="images/tild6136-6139-4432-a161-643330393139__0-yd9t51vzw2utez0tje.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209900450" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Сама формула динамического диапазона тривиальна: <br /><br /> СМЕЩ(Лист2!$A$2;0;0;СЧЁТЗ(Лист2!$A$2:$A$100);1) <br /><br /> Напоследок приведём пример создания динамического диапазона через функцию ИНДЕКС. В общем случае предпочтительно применять неволатильные функции. ИНДЕКС как раз такая, а вот СМЕЩ – волатильная. Результат применения ИНДЕКС по внешнему виду такой же, как и СМЕЩ.<br /></div></div></div></div></div></div><div id="rec209900451" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3539-3234-4165-b539-353630313036__-__empty__qn49d03dwephdi7j7ptt.jpg" data-original="images/tild3539-3234-4165-b539-353630313036__qn49d03dwephdi7j7ptt.jpg" imgfield="img" /><meta itemprop="image" content="images/tild3539-3234-4165-b539-353630313036__qn49d03dwephdi7j7ptt.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209902764" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild6164-6366-4061-a466-313964316635__-__empty__ohnd_wm3ov72ojnhfvgd.jpg" data-original="images/tild6164-6366-4061-a466-313964316635__ohnd_wm3ov72ojnhfvgd.jpg" imgfield="img" /><meta itemprop="image" content="images/tild6164-6366-4061-a466-313964316635__ohnd_wm3ov72ojnhfvgd.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209902871" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Рассмотрим формулу получения динамического диапазона: <br /><br /> =Лист2!$A$2:ИНДЕКС(Лист2!$A$2:$A$100;ПОИСКПОЗ(ПОВТОР("я";255);Лист2!$A$2:$A$100;1)) <br /><br /> Дело в том, что ИНДЕКС возвращает ссылку, если стоит завершающим выражением диапазона (стоит после двоеточия). Чтобы получить адрес последней ячейки нам надо вычислить номер строки ячейки в диапазоне. Его мы получаем через функцию ПОИСКПОЗ. Она ищет определённое значение в указанном диапазоне. С помощью параметра Тип_сопоставления мы указываем функции искать ближайшее меньшее значение. При этом указываем заведомо большее значение для поиска. В результате функция обязательно дойдёт до последней ячейки.Если поиск идёт по числам, то можно использовать 9E+307. Для текста применим функцию ПОВТОР. <br /><br /> Конструкция ПОВТОР("я";255) создаёт строку из 255 литер "я". При сравнении практически любой текст окажется «меньше», и функция найдёт последнюю строку. Ещё одним плюсом применения функции ИНДЕКС является нечувствительность к пустым ячейкам. <br /><br /> Результат для СМЕЩ:<br /></div></div></div></div></div></div><div id="rec209903050" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild6131-3965-4838-b664-393035613732__-__empty__dayjvp20qcsdjuq2gnqj.jpg" data-original="images/tild6131-3965-4838-b664-393035613732__dayjvp20qcsdjuq2gnqj.jpg" imgfield="img" /><meta itemprop="image" content="images/tild6131-3965-4838-b664-393035613732__dayjvp20qcsdjuq2gnqj.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209903215" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">А так ведёт себя ИНДЕКС:</div></div></div></div></div></div><div id="rec209903330" class="r t-rec t-rec_pt_15 t-rec_pb_120" style="padding-top:15px;padding-bottom:120px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3439-3937-4231-b362-353030626663__-__empty__ivhlkiq_g5zgnekuqh7p.jpg" data-original="images/tild3439-3937-4231-b362-353030626663__ivhlkiq_g5zgnekuqh7p.jpg" imgfield="img" /><meta itemprop="image" content="images/tild3439-3937-4231-b362-353030626663__ivhlkiq_g5zgnekuqh7p.jpg"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div></div><!--/allrecords-->
<!DOCTYPE html><html> <head><meta charset="utf-8" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--metatextblock--><title>Отчёты о рассылках из UniSender в Power BI. Часть 1. Описание отчета и получение данных из Unisender | Блог NeedForData про Power BI и Excel для интернет-маркетинга</title><meta name="description" content="Первая часть статьи по созданию автоматических отчетов из сервиса рассылок Unisender в Power BI от EmailSoldiers." /><meta property="og:url" content="https://needfordata.ru/blog/otchyoty-o-rassylkah-iz-unisender-v-power-bi-chast-1" /><meta property="og:title" content="Отчёты о рассылках из UniSender в Power BI. Часть 1. Описание отчета и получение данных из Unisender | Блог NeedForData про Power BI и Excel для интернет-маркетинга" /><meta property="og:description" content="Первая часть статьи по созданию автоматических отчетов из сервиса рассылок Unisender в Power BI от EmailSoldiers." /><meta property="og:type" content="website" /><meta property="og:image" content="images/tild3862-6536-4163-b638-306662323339__waiau15.png" /><link rel="canonical" href="https://needfordata.ru/blog/otchyoty-o-rassylkah-iz-unisender-v-power-bi-chast-1"><!--/metatextblock--><meta property="fb:app_id" content="257953674358265" /><meta name="format-detection" content="telephone=no" /><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://ws.tildacdn.com"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><!-- Assets --><link rel="stylesheet" href="css/tilda-grid-3.0.min.css" type="text/css" media="all" /><link rel="stylesheet" href="css/tilda-blocks-2.14.css?t=1645254405" type="text/css" media="all" /><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;500;600;700&subset=latin,cyrillic" rel="stylesheet"><link rel="stylesheet" href="css/tilda-animation-1.0.min.css" type="text/css" media="all" /><link rel="stylesheet" href="css/tilda-cover-1.0.min.css" type="text/css" media="all" /><link rel="stylesheet" href="css/tilda-slds-1.4.min.css" type="text/css" media="print" onload="this.media='all';" /><noscript><link rel="stylesheet" href="css/tilda-slds-1.4.min.css" type="text/css" media="all" /></noscript><link rel="stylesheet" href="css/tilda-zoom-2.0.min.css" type="text/css" media="print" onload="this.media='all';" /><noscript><link rel="stylesheet" href="css/tilda-zoom-2.0.min.css" type="text/css" media="all" /></noscript><script src="js/jquery-1.10.2.min.js"></script><script src="js/tilda-scripts-3.0.min.js"></script><script src="js/tilda-blocks-2.7.js?t=1645254405"></script><script src="js/lazyload-1.3.min.js" charset="utf-8" async></script><script src="js/tilda-animation-1.0.min.js" charset="utf-8" async></script><script src="js/tilda-cover-1.0.min.js" charset="utf-8" async></script><script src="js/tilda-events-1.0.min.js" charset="utf-8" async></script><script src="js/tilda-slds-1.4.min.js" charset="utf-8" async></script><script src="js/hammer.min.js" charset="utf-8" async></script><script src="js/tilda-zoom-2.0.min.js" charset="utf-8" async></script><link rel="icon" href="images/tild3662-3930-4236-a439-636138646665__needfordatafavicon.svg" type="image/svg"><script type="text/javascript">window.dataLayer = window.dataLayer || [];</script><!-- Google Tag Manager --><script type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);	})(window,document,'script','dataLayer','GTM-P7MJHR');</script><!-- End Google Tag Manager --><script type="text/javascript">if((/bot|google|yandex|baidu|bing|msn|duckduckbot|teoma|slurp|crawler|spider|robot|crawling|facebook/i.test(navigator.userAgent))===false && typeof(sessionStorage)!='undefined' && sessionStorage.getItem('visited')!=='y'){	var style=document.createElement('style');	style.type='text/css';	style.innerHTML='@media screen and (min-width: 980px) {.t-records {opacity: 0;}.t-records_animated {-webkit-transition: opacity ease-in-out .2s;-moz-transition: opacity ease-in-out .2s;-o-transition: opacity ease-in-out .2s;transition: opacity ease-in-out .2s;}.t-records.t-records_visible {opacity: 1;}}';	document.getElementsByTagName('head')[0].appendChild(style);	$(document).ready(function() {	$('.t-records').addClass('t-records_animated');	setTimeout(function(){ $('.t-records').addClass('t-records_visible'); sessionStorage.setItem('visited','y');	},400);	});
}</script></head><body class="t-body" style="margin:0;"><!--allrecords--><div id="allrecords" data-tilda-export="yes" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="14542" data-tilda-page-id="12580582" data-tilda-page-alias="blog/otchyoty-o-rassylkah-iz-unisender-v-power-bi-chast-1" data-tilda-formskey="2bb761110255242a2bbb1bf3f837b680" data-tilda-lazy="yes" data-tilda-project-headcode="yes"><!--header--><div id="t-header" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="14542" data-tilda-page-id="61936" data-tilda-page-alias="header" data-tilda-formskey="2bb761110255242a2bbb1bf3f837b680" data-tilda-project-headcode="yes"></div><!--/header--><div id="rec209938967" class="r t-rec" style=" " data-animationappear="off" data-record-type="891" ><!-- cover --><div class="t-cover" id="recorddiv209938967" bgimgfield="img" style="height:450px; background-image:-webkit-linear-gradient(top, #ccc, #777); background-image:-moz-linear-gradient(top, #ccc, #777); background-image:-o-linear-gradient(top, #ccc, #777); background-image:-ms-linear-gradient(top, #ccc, #777); background-image:linear-gradient(top, #ccc, #777); " ><div class="t-cover__carrier" id="coverCarry209938967" data-content-cover-id="209938967" data-content-cover-bg="" data-content-cover-height="450px" data-content-cover-parallax="" style="height:450px;background-attachment:scroll; "></div> <div class="t-cover__filter" style="height:450px;background-image: -moz-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: -webkit-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: -o-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: -ms-linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));background-image: linear-gradient(top, rgba(14,31,47,1), rgba(24,45,66,1));filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#000e1f2f', endColorstr='#00182d42');"></div><div class="t891"> <div class="t-container"> <div class="t-col t-col_12"> <div class="t-cover__wrapper t-valign_middle" style="height:450px;"> <div class="t891__wrapper" data-hook-content="covercontent"> <div class="t891__title t-title t-title_xl" style="padding-top:100px;text-shadow: 0px 2px 5px rgba(0, 0, 0, 0.0);" field="title"><div style="font-size:46px;text-align:left;" data-customstyle="yes">Отчёты о рассылках из UniSender в Power BI.<br /> Часть 1. Описание отчета и получение<br /> данных из Unisender<br /></div></div> <div class="t891__descr t-descr t-descr_xl " style="" field="descr"><div style="font-size:18px;text-align:left;" data-customstyle="yes">Первая часть статьи по созданию автоматических отчетов из сервиса рассылок Unisender в Power BI от <a href="http://emailsoldiers.ru/" target="_blank">EmailSoldiers</a>.</div></div> <span class="space"></span> </div> </div> </div> </div></div> </div> </div><div id="rec209938971" class="r t-rec t-rec_pt_90 t-rec_pb_0" style="padding-top:90px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Разберем получившийся отчет и научимся забирать данные о рассылках из Unisender по API. <br /><a href="https://learn.needfordata.ru/blog/otchyoty-o-rassylkah-iz-unisender-v-power-bi-chast-2">Вторая часть статьи по ссылке</a>. <br /><br /> Сегодня мы соберём данные о email-кампаниях из UniSender в красивые отчёты в Microsoft Power BI. Это полезно для наглядности и простого наблюдения за показателями рассылок. Такие отчёты автоматически обновляются, и вам не придётся каждый месяц собирать их вручную. Доступ к ним можно давать клиентам, чтобы те смогли посмотреть отчёт в любой момент. Удобно ещё и то, что однажды сделав отчёт, на его базе можно создавать и другие, всего лишь немного подправив первый. <br /><br /> Хотя эта инструкция учит, как забирать данные из UniSender, вы сможете применять полученные знания не только для этой системы рассылок, но и практически для любого сервиса, необязательно из области email-маркетинга. <br /><br /> Давайте прежде всего разберемся, для чего всё это нужно. <br /><br /> Использовать будем данные компании <a href="https://needfordata.ru/">NeedForData</a>. <br /><br /> В <a href="https://app.powerbi.com/view?r=eyJrIjoiNGUwMDdjMGEtY2FhYi00NDI2LTljYjYtZjkzNzFiNjg2ZjM0IiwidCI6IjdlM2VmYjk3LTkwZTItNDEyMi1hYWU0LTZhMTE3MjRiNGIyNCIsImMiOjl9">нашем отчёте</a> 4 страницы. <br /><br /> На первой странице — ключевые показатели кампаний. До применения фильтров мы имеем сводный отчёт за все время использования платформы. В фильтрах мы можем выбрать отчётный период / списки подписчиков, статистика которых нас интересует / отдельную рассылку.<br /></div></div></div></div></div></div><div id="rec209938972" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild6633-3763-4232-a461-646636333733__-__empty__pasted-image-0.png" data-original="images/tild6633-3763-4232-a461-646636333733__pasted-image-0.png" imgfield="img" /><meta itemprop="image" content="images/tild6633-3763-4232-a461-646636333733__pasted-image-0.png"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209938974" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">На второй странице уже размещёны все показатели в табличном виде. Тут присутствует фильтр по спискам / также в один клик можно получить сводный отчёт за месяц работы.</div></div></div></div></div></div><div id="rec209938975" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3735-3631-4066-b937-326133303161__-__empty__pasted-image-0-1.png" data-original="images/tild3735-3631-4066-b937-326133303161__pasted-image-0-1.png" imgfield="img" /><meta itemprop="image" content="images/tild3735-3631-4066-b937-326133303161__pasted-image-0-1.png"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209938976" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes"> Третья страница «Клики» демонстрирует статистику переходов. Мы можем выявить самые популярные ссылки в письмах и получить представление о том, какие письма отработали эффективно, какие нет / на какие результаты фактически нацелены произведенные рассылки.</div></div></div></div></div></div><div id="rec209938977" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3466-3565-4965-b431-303164616133__-__empty__pasted-image-0-2.png" data-original="images/tild3466-3565-4965-b431-303164616133__pasted-image-0-2.png" imgfield="img" /><meta itemprop="image" content="images/tild3466-3565-4965-b431-303164616133__pasted-image-0-2.png"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209938978" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Страница «Листы» в данном отчёте отражает общее состояние списков подписчиков. Если заказчик активно использует формы подписки на сайте, если подписчики попадают в базу подписчиков при регистрации на сайте или при заказе услуги / совершении покупки на сайте, то имеет смысл добавить в этот отчёт график динамики роста базы.</div></div></div></div></div></div><div id="rec209938979" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3638-3835-4631-a334-626131396537__-__empty__pasted-image-0-3.png" data-original="images/tild3638-3835-4631-a334-626131396537__pasted-image-0-3.png" imgfield="img" /><meta itemprop="image" content="images/tild3638-3835-4631-a334-626131396537__pasted-image-0-3.png"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209938981" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Этот отчёт составлен из данных, интересных нам и конкретному заказчику. Вы сможете настроить то, что важно для вас.</div></div></div></div></div></div><div id="rec209941050" class="r t-rec t-rec_pt_15 t-rec_pb_0" style="padding-top:15px;padding-bottom:0px; " data-record-type="128" ><!-- T120 --><div class="t120"> <div class="t-container t-align_left"> <div class="t-col t-col_8 t-prefix_2"> <h3 class="t120__title t-heading t-heading_sm" field="title" style="font-size:16px;">Запросы к API<br /></h3> </div> </div></div></div><div id="rec209940892" class="r t-rec t-rec_pt_0 t-rec_pb_0" style="padding-top:0px;padding-bottom:0px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Итак. Отчёт у нас состоит из четырех страниц. В нём задействованы только данные из UniSender. <br /><br /> Сегодня мы рассмотрим, как создавать именно такие отчёты. Следующие шаги — добавление данных из Яндекс.Метрики и Google Analytics, это мы рассмотрим в следующий раз. <br /><br /> Данные из UniSender мы будем получать с помощью API. В <a href="https://www.unisender.com/ru/support/integration/api/">справке</a> находим соответствующую информацию. <br /><br /> В общем виде запрос к API UniSender выглядит так: <a href="http://api.unisender.com/ru/LANG/api/METHOD?format=json&amp;api_key=KEY&amp;arg1=ARG_1&amp;argN=ARG_N">http://api.unisender.com/LANG/api/METHOD?format=json&amp;api_key=KEY&amp;arg1=ARG_1&amp;argN=ARG_N</a> <br /><br /> Как видно, для совершения запросов нам нужен API KEY. <br /><br /> Обычно его можно получить в личном кабинете сервисов, и UniSender в этом плане не является исключением. <br /><br /> Идём в аккаунт UniSender. Далее идём в Настройки аккаунта → «Интеграция и API» → копируем «Ключ доступа к API». <br /><br /> В справке смотрим, какие методы предоставляет API платформы. Сначала объём информации может показаться устрашающим. Но мы сразу можем исключить из просмотра методы действий (например, целый раздел методов «Методы для партнёрских сайтов», раздел «Создание и отправка сообщений» и т.д.). <br /><br /> Для формирования отчёта нам нужны методы, возвращающие какие-то данные, которые могут быть пригодны для изучения. Даже по заголовкам с коротким описанием можно выделить потенциальных кандидатов на попадание в отчёт (в конечном счёте, далеко не все они будут использованы): <br /><br /> getLists — получить списки рассылки с их кодами<br />getTotalContactsCount — получить размер базы пользователя<br />getContactCount — получить количество контактов в списке<br />getWebVersion — получить ссылку на веб-версию отправленного письма<br />listTemplates — получить список всех шаблонов без body<br />getCampaignDeliveryStats — получить отчёт о статусах доставки сообщений для заданной рассылки<br />getCampaignAggregateStats — получить отчёт о статусах доставки сообщений для заданной рассылки, сгруппированных по типам результата<br />getVisitedLinks — получить статистику переходов по ссылкам<br />getCampaigns — получить список рассылок<br />getCampaignStatus — получить статус рассылки<br />getMessages — получить список сообщений<br />getMessage — получение информации об SMS или email сообщении<br />listMessages — получить список сообщений без тела и вложений<br />getTags — получить список пользовательских меток <br /><br /> <strong>Теперь протестируем работу API.</strong> <br /><br /> Для начала проверим, как работает метод <a href="https://www.unisender.com/ru/support/integration/api/getcampaigns">getCampaigns</a>.<br />Этот метод служит для получения списка всех имеющихся рассылок. <br /><br /> Для быстрого тестирования запросов я люблю использовать сервис <a href="https://www.getpostman.com/">Postman</a>. Предлагаю вам его также скачать и установить. <br /><br /> Запускаем Postman и собираем запрос: <br /><br /> <a href="http://api.unisender.com/ru/api/getCampaigns?format=json&amp;api_key=KEY&amp;from=TIME&amp;to=TIME">http://api.unisender.com/ru/api/getCampaigns?format=json&amp;api_key=KEY&amp;from=TIME&amp;to=TIME</a> <br /><br /> Для совершения запросов предпочтительно использовать метод POST. Все параметры должны быть в кодировке UTF-8. В примере выше параметры указаны в GET-запросе, но можно передавать их и в POST. Более того, параметр api_key мы настоятельно рекомендуем передавать через POST, чтобы он не сохранялся в логах прокси-серверов. <br /><br /> В документации метода говорится, что в запросе мы обязаны использовать api_key. Временной интервал from / to не является обязательным и сейчас мы его не будем использовать, но в будущем он нам пригодится. <br /><br /> Сейчас посмотрим, что же мы в результате получим. <br /><br /> Отправляем запрос:<br /></div></div></div></div></div></div><div id="rec209974176" class="r t-rec t-rec_pt_15 t-rec_pb_15" style="padding-top:15px;padding-bottom:15px; " data-record-type="224" ><!-- T196 --><div class="t196"> <div class="t-container" itemscope itemtype="http://schema.org/ImageObject"> <div class="t-col t-col_8 t-prefix_2 t-align_center"> <img class="t196__img t-img" src="images/tild3063-6238-4533-b562-373763383534__-__empty__fa21b6f12d.png" data-original="images/tild3063-6238-4533-b562-373763383534__fa21b6f12d.png" imgfield="img" /><meta itemprop="image" content="images/tild3063-6238-4533-b562-373763383534__fa21b6f12d.png"> </div> <div class="t-col t-col_2 "> <div class="t196__descr t-descr t-descr_xs" style="" field="title" itemprop="name"></div> </div> </div></div></div><div id="rec209974407" class="r t-rec t-rec_pt_0 t-rec_pb_120" style="padding-top:0px;padding-bottom:120px; " data-record-type="106" ><!-- T004 --><div class="t004"><div class="t-container "> <div class="t-col t-col_8 t-prefix_2"><div field="text" class="t-text t-text_md " style=""><div style="font-size:14px;" data-customstyle="yes">Отлично, API работает. Мы получили наши первые данные. Выглядит неплохо. <br /><br /> Как мы видим, полученные данные соответствуют примеру возвращаемого значения, приведенному в документации. <br /><br /> Обратим внимание на заголовок ответа, видим, что ответ имеет JSON формат. Об этом же нам написано и в документации: «Ответ приходит в виде объекта формата JSON.» При помощи сервиса http://jsoneditoronline.org мы можем подсчитать объём полученных данных. <br /><br /> У нас получилось 1444 рассылок, что вполне соответствует действительности. <br /><br /> Я так и не понял, какую функцию выполняет «аргумент limit со значением 50 по умолчанию», но пока мы получили всё, что хотели. Рассылок в текущем аккаунте гораздо меньше 10 000= (лимит метода на один запрос), поэтому пока мы можем использовать этот метод без дополнительных заморочек. <br /><br /> Теперь попробуем использовать метод getCampaigns для получения данных в Power BI desktop. Если вы ещё его не устанавливали, то сейчас самое время это сделать. <br /><br /> Я рекомендую использовать англоязычную версию программы, поскольку большая часть обучающих материалов, обсуждений на форумах, в статьях подразумевают работу с англоязычной версией. Чтобы её скачать, надо зайти на <a href="https://powerbi.microsoft.com/en-us/">англоязычную версию официального сайта Power BI</a>. <br /><br /> Далее кликаем «Get started free», скачиваем (во всплывающей форме можно ничего не писать), устанавливаем.<br /></div></div></div></div></div></div></div><!--/allrecords--><!-- Stat --><script type="text/javascript">if (! window.mainTracker) { window.mainTracker = 'tilda'; }	setTimeout(function(){	(function (d, w, k, o, g) { var n=d.getElementsByTagName(o)[0],s=d.createElement(o),f=function(){n.parentNode.insertBefore(s,n);}; s.type = "text/javascript"; s.async = true; s.key = k; s.id = "tildastatscript"; s.src=g; if (w.opera=="[object Opera]") {d.addEventListener("DOMContentLoaded", f, false);} else { f(); } })(document, window, '4eb7231bc2c18471490f34b4b396f16e','script','js/tilda-stat-1.0.min.js');	}, 2000);</script><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P7MJHR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!-- End Google Tag Manager (noscript) --></body></html>